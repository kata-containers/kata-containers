name: Kata Containers Nightly CI
on:
  schedule:
    cron: '0 0 * * *'

env:
  COMMIT_HASH: ${GITHUB_REF}

jobs:
  set-fake-pr-number:
    runs-on: ubuntu-latest
    run: |
      echo "PR_NUMBER=$(date +%Y%m%d%H%M%S)" >> "$GITHUB_ENV"

  kata-containers-ci-on-push:
    uses: ./.github/workflows/ci.yaml
    with:
      commit-hash: ${{ env.COMMIT_HASH }}
      pr-number: ${{ env.PR_NUMBER }}
      tag: ${{ env.PR_NUMBER }}-${{ env.COMMIT_HASH }}-nightly
