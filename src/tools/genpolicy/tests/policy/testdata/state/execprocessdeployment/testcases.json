[
  {
    "allowed": true,
    "description": "create container request for deployment's only container",
    "request": {
      "OCI": {
        "Annotations": {
          "io.katacontainers.pkg.oci.bundle_path": "/run/containerd/io.containerd.runtime.v2.task/k8s.io/de22f4859da69a058e9d7f162d8e27244919c24d3ff2262e46cf56f695a34b5d",
          "io.katacontainers.pkg.oci.container_type": "pod_container",
          "io.kubernetes.cri.container-name": "execprocessnamed",
          "io.kubernetes.cri.container-type": "container",
          "io.kubernetes.cri.image-name": "quay.io/prometheus/busybox:latest",
          "io.kubernetes.cri.sandbox-id": "c069a0850eb7894c6499133e2c6b5ccd543ebf3c32966a7c87512c9d0322061f",
          "io.kubernetes.cri.sandbox-name": "execprocessnamed-7c56d66754-pq9qp",
          "io.kubernetes.cri.sandbox-namespace": "default",
          "io.kubernetes.cri.sandbox-uid": "e6a10dbc-f413-427c-b59c-cdbd2dcb5003"
        },
        "Hooks": null,
        "Hostname": "",
        "Linux": {
          "CgroupsPath": "kubepods-besteffort-pode6a10dbc_f413_427c_b59c_cdbd2dcb5003.slice:cri-containerd:de22f4859da69a058e9d7f162d8e27244919c24d3ff2262e46cf56f695a34b5d",
          "Devices": [],
          "GIDMappings": [],
          "IntelRdt": null,
          "MaskedPaths": [
            "/proc/asound",
            "/proc/acpi",
            "/proc/kcore",
            "/proc/keys",
            "/proc/latency_stats",
            "/proc/timer_list",
            "/proc/timer_stats",
            "/proc/sched_debug",
            "/proc/scsi",
            "/sys/firmware",
            "/sys/devices/virtual/powercap"
          ],
          "MountLabel": "",
          "Namespaces": [
            {
              "Path": "",
              "Type": "ipc"
            },
            {
              "Path": "",
              "Type": "uts"
            },
            {
              "Path": "",
              "Type": "mount"
            }
          ],
          "ReadonlyPaths": [
            "/proc/bus",
            "/proc/fs",
            "/proc/irq",
            "/proc/sys",
            "/proc/sysrq-trigger"
          ],
          "Resources": {
            "BlockIO": null,
            "CPU": {
              "Cpus": "",
              "Mems": "",
              "Period": 100000,
              "Quota": 0,
              "RealtimePeriod": 0,
              "RealtimeRuntime": 0,
              "Shares": 2
            },
            "Devices": [],
            "HugepageLimits": [],
            "Memory": {
              "DisableOOMKiller": false,
              "Kernel": 0,
              "KernelTCP": 0,
              "Limit": 0,
              "Reservation": 0,
              "Swap": 0,
              "Swappiness": 0
            },
            "Network": null,
            "Pids": null
          },
          "RootfsPropagation": "",
          "Seccomp": null,
          "Sysctl": {},
          "UIDMappings": []
        },
        "Mounts": [
          {
            "destination": "/proc",
            "options": [
              "nosuid",
              "noexec",
              "nodev"
            ],
            "source": "proc",
            "type_": "proc"
          },
          {
            "destination": "/dev",
            "options": [
              "nosuid",
              "strictatime",
              "mode=755",
              "size=65536k"
            ],
            "source": "tmpfs",
            "type_": "tmpfs"
          },
          {
            "destination": "/dev/pts",
            "options": [
              "nosuid",
              "noexec",
              "newinstance",
              "ptmxmode=0666",
              "mode=0620",
              "gid=5"
            ],
            "source": "devpts",
            "type_": "devpts"
          },
          {
            "destination": "/dev/mqueue",
            "options": [
              "nosuid",
              "noexec",
              "nodev"
            ],
            "source": "mqueue",
            "type_": "mqueue"
          },
          {
            "destination": "/sys",
            "options": [
              "nosuid",
              "noexec",
              "nodev",
              "ro"
            ],
            "source": "sysfs",
            "type_": "sysfs"
          },
          {
            "destination": "/sys/fs/cgroup",
            "options": [
              "nosuid",
              "noexec",
              "nodev",
              "relatime",
              "ro"
            ],
            "source": "cgroup",
            "type_": "cgroup"
          },
          {
            "destination": "/etc/hosts",
            "options": [
              "rbind",
              "rprivate",
              "rw"
            ],
            "source": "/run/kata-containers/shared/containers/de22f4859da69a058e9d7f162d8e27244919c24d3ff2262e46cf56f695a34b5d-caaca2830e5ed2bd-hosts",
            "type_": "bind"
          },
          {
            "destination": "/dev/termination-log",
            "options": [
              "rbind",
              "rprivate",
              "rw"
            ],
            "source": "/run/kata-containers/shared/containers/de22f4859da69a058e9d7f162d8e27244919c24d3ff2262e46cf56f695a34b5d-5e23a5cd6aabdf40-termination-log",
            "type_": "bind"
          },
          {
            "destination": "/etc/hostname",
            "options": [
              "rbind",
              "rprivate",
              "rw"
            ],
            "source": "/run/kata-containers/shared/containers/de22f4859da69a058e9d7f162d8e27244919c24d3ff2262e46cf56f695a34b5d-d828ac9e9fc033a1-hostname",
            "type_": "bind"
          },
          {
            "destination": "/etc/resolv.conf",
            "options": [
              "rbind",
              "rprivate",
              "rw"
            ],
            "source": "/run/kata-containers/shared/containers/de22f4859da69a058e9d7f162d8e27244919c24d3ff2262e46cf56f695a34b5d-c06f189b601baf96-resolv.conf",
            "type_": "bind"
          },
          {
            "destination": "/dev/shm",
            "options": [
              "rbind"
            ],
            "source": "/run/kata-containers/sandbox/shm",
            "type_": "bind"
          },
          {
            "destination": "/var/run/secrets/kubernetes.io/serviceaccount",
            "options": [
              "rbind",
              "rprivate",
              "ro"
            ],
            "source": "/run/kata-containers/shared/containers/de22f4859da69a058e9d7f162d8e27244919c24d3ff2262e46cf56f695a34b5d-708e23948ffe9cd6-serviceaccount",
            "type_": "bind"
          }
        ],
        "Process": {
          "ApparmorProfile": "cri-containerd.apparmor.d",
          "Args": [
            "sleep",
            "3600"
          ],
          "Capabilities": {
            "Ambient": [],
            "Bounding": [
              "CAP_CHOWN",
              "CAP_DAC_OVERRIDE",
              "CAP_FSETID",
              "CAP_FOWNER",
              "CAP_MKNOD",
              "CAP_NET_RAW",
              "CAP_SETGID",
              "CAP_SETUID",
              "CAP_SETFCAP",
              "CAP_SETPCAP",
              "CAP_NET_BIND_SERVICE",
              "CAP_SYS_CHROOT",
              "CAP_KILL",
              "CAP_AUDIT_WRITE"
            ],
            "Effective": [
              "CAP_CHOWN",
              "CAP_DAC_OVERRIDE",
              "CAP_FSETID",
              "CAP_FOWNER",
              "CAP_MKNOD",
              "CAP_NET_RAW",
              "CAP_SETGID",
              "CAP_SETUID",
              "CAP_SETFCAP",
              "CAP_SETPCAP",
              "CAP_NET_BIND_SERVICE",
              "CAP_SYS_CHROOT",
              "CAP_KILL",
              "CAP_AUDIT_WRITE"
            ],
            "Inheritable": [],
            "Permitted": [
              "CAP_CHOWN",
              "CAP_DAC_OVERRIDE",
              "CAP_FSETID",
              "CAP_FOWNER",
              "CAP_MKNOD",
              "CAP_NET_RAW",
              "CAP_SETGID",
              "CAP_SETUID",
              "CAP_SETFCAP",
              "CAP_SETPCAP",
              "CAP_NET_BIND_SERVICE",
              "CAP_SYS_CHROOT",
              "CAP_KILL",
              "CAP_AUDIT_WRITE"
            ]
          },
          "ConsoleSize": null,
          "Cwd": "/",
          "Env": [
            "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin",
            "HOSTNAME=execprocessnamed-7c56d66754-pq9qp",
            "KUBERNETES_PORT_443_TCP_PROTO=tcp",
            "KUBERNETES_PORT_443_TCP_PORT=443",
            "KUBERNETES_PORT_443_TCP_ADDR=10.0.0.1",
            "KUBERNETES_SERVICE_HOST=10.0.0.1",
            "KUBERNETES_SERVICE_PORT=443",
            "KUBERNETES_SERVICE_PORT_HTTPS=443",
            "KUBERNETES_PORT=tcp://10.0.0.1:443",
            "KUBERNETES_PORT_443_TCP=tcp://10.0.0.1:443"
          ],
          "NoNewPrivileges": false,
          "OOMScoreAdj": 1000,
          "Rlimits": [],
          "SelinuxLabel": "",
          "Terminal": false,
          "User": {
            "AdditionalGids": [
              0
            ],
            "GID": 0,
            "UID": 0,
            "Username": ""
          }
        },
        "Root": {
          "Path": "/run/kata-containers/de22f4859da69a058e9d7f162d8e27244919c24d3ff2262e46cf56f695a34b5d/rootfs",
          "Readonly": false
        },
        "Solaris": null,
        "Version": "1.1.0",
        "Windows": null
      },
      "container_id": "de22f4859da69a058e9d7f162d8e27244919c24d3ff2262e46cf56f695a34b5d",
      "devices": [],
      "exec_id": "de22f4859da69a058e9d7f162d8e27244919c24d3ff2262e46cf56f695a34b5d",
      "sandbox_pidns": false,
      "shared_mounts": [],
      "stderr_port": 0,
      "stdin_port": 0,
      "stdout_port": 0,
      "storages": [
        {
          "driver": "image_guest_pull",
          "driver_options": [
            "image_guest_pull={\"metadata\":{\"io.katacontainers.pkg.oci.bundle_path\":\"/run/containerd/io.containerd.runtime.v2.task/k8s.io/de22f4859da69a058e9d7f162d8e27244919c24d3ff2262e46cf56f695a34b5d\",\"io.katacontainers.pkg.oci.container_type\":\"pod_container\",\"io.kubernetes.cri.container-name\":\"execprocessnamed\",\"io.kubernetes.cri.container-type\":\"container\",\"io.kubernetes.cri.image-name\":\"quay.io/prometheus/busybox:latest\",\"io.kubernetes.cri.sandbox-id\":\"c069a0850eb7894c6499133e2c6b5ccd543ebf3c32966a7c87512c9d0322061f\",\"io.kubernetes.cri.sandbox-name\":\"execprocessnamed-7c56d66754-pq9qp\",\"io.kubernetes.cri.sandbox-namespace\":\"default\",\"io.kubernetes.cri.sandbox-uid\":\"e6a10dbc-f413-427c-b59c-cdbd2dcb5003\"}}"
          ],
          "fs_group": null,
          "fstype": "overlay",
          "mount_point": "/run/kata-containers/de22f4859da69a058e9d7f162d8e27244919c24d3ff2262e46cf56f695a34b5d/rootfs",
          "options": [],
          "source": "quay.io/prometheus/busybox:latest"
        }
      ],
      "string_user": null,
      "type": "CreateContainer"
    }
  },
  {
    "allowed": true,
    "description": "test exec process in deployment's container with correct args",
    "request": {
      "container_id": "de22f4859da69a058e9d7f162d8e27244919c24d3ff2262e46cf56f695a34b5d",
      "exec_id": "cc5d171e-57fa-4b0d-995c-af55301e92e9",
      "process": {
        "ApparmorProfile": "",
        "Args": [
          "/bin/true"
        ],
        "Capabilities": null,
        "ConsoleSize": null,
        "Cwd": "/",
        "Env": [
          "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin",
          "HOSTNAME=execprocessnamed-7c56d66754-pq9qp",
          "KUBERNETES_PORT_443_TCP_PROTO=tcp",
          "KUBERNETES_PORT_443_TCP_PORT=443",
          "KUBERNETES_PORT_443_TCP_ADDR=10.0.0.1",
          "KUBERNETES_SERVICE_HOST=10.0.0.1",
          "KUBERNETES_SERVICE_PORT=443",
          "KUBERNETES_SERVICE_PORT_HTTPS=443",
          "KUBERNETES_PORT=tcp://10.0.0.1:443",
          "KUBERNETES_PORT_443_TCP=tcp://10.0.0.1:443"
        ],
        "NoNewPrivileges": false,
        "OOMScoreAdj": 0,
        "Rlimits": [],
        "SelinuxLabel": "",
        "Terminal": false,
        "User": {
          "AdditionalGids": [
            0
          ],
          "GID": 0,
          "UID": 0,
          "Username": ""
        }
      },
      "stderr_port": 0,
      "stdin_port": 0,
      "stdout_port": 0,
      "string_user": null,
      "type": "ExecProcess"
    }
  }
]
