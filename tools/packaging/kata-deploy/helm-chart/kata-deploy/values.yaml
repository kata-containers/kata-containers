imagePullPolicy: Always

imagePullSecrets: []

image:
  reference: quay.io/kata-containers/kata-deploy
  tag: ""

k8sDistribution: "k8s"  # k8s, k3s, rke2, k0s, microk8s

# Node selector to control which nodes the kata-deploy daemonset runs on
# Example:
# nodeSelector:
#   kata-containers: "enabled"
#   node-type: "worker"
nodeSelector: {}

debug: false

snapshotter:
  setup: []  # ["nydus", "erofs"] or []

# See MAINTENANCE.md for field descriptions and maintenance guide
# NOTE: All shims are disabled by default. Enable the ones you need explicitly.
shims:
  clh: # cloud-hypervisor, golang runtime
    enabled: false
    supportedArches:
      - amd64
      - arm64
    allowedHypervisorAnnotations: []
    containerd:
      snapshotter: ""
  cloud-hypervisor: # rust runtime
    enabled: false
    supportedArches:
      - amd64
      - arm64
    allowedHypervisorAnnotations: []
    containerd:
      snapshotter: ""
  dragonball: # rust runtime
    enabled: false
    supportedArches:
      - amd64
      - arm64
    allowedHypervisorAnnotations: []
    containerd:
      snapshotter: ""
  
  fc: # firecracker, golang runtime
    enabled: false
    supportedArches:
      - amd64
      - arm64
    allowedHypervisorAnnotations: []
    containerd:
      snapshotter: "devmapper" # requires pre-configuration on the user side
  firecracker: # firecracker, golang runtime
    enabled: false
    supportedArches:
      - amd64
      - arm64
    allowedHypervisorAnnotations: []
    containerd:
      snapshotter: "devmapper" # requires pre-configuration on the user side
 
  qemu: # golang runtime
    enabled: false
    supportedArches:
      - amd64
      - arm64
      - s390x
      - ppc64le
    allowedHypervisorAnnotations: []
    containerd:
      snapshotter: ""
  qemu-runtime-rs: # rust runtime
    enabled: false
    supportedArches:
      - amd64
      - arm64
      - s390x
      - ppc64le
    allowedHypervisorAnnotations: []
    containerd:
      snapshotter: ""
 
  qemu-nvidia-gpu: # golang runtime
    enabled: false
    supportedArches:
      - amd64
      - arm64
      - s390x
      - ppc64le
    allowedHypervisorAnnotations: []
    containerd:
      snapshotter: ""
  qemu-nvidia-gpu-snp: # golang runtime
    enabled: false
    supportedArches:
      - amd64
    allowedHypervisorAnnotations: []
    containerd:
      snapshotter: ""
      forceGuestPull: true
    crio:
      guestPull: true
    agent:
      httpsProxy: ""
      noProxy: ""
  qemu-nvidia-gpu-tdx: # golang runtime
    enabled: false
    supportedArches:
      - amd64
    allowedHypervisorAnnotations: []
    containerd:
      snapshotter: ""
      forceGuestPull: true
    crio:
      guestPull: true
    agent:
      httpsProxy: ""
      noProxy: ""
  qemu-snp: # golang runtime
    enabled: false
    supportedArches:
      - amd64
    allowedHypervisorAnnotations: []
    containerd:
      snapshotter: nydus
      forceGuestPull: false
    crio:
      guestPull: true
    agent:
      httpsProxy: ""
      noProxy: ""
  qemu-tdx: # golang runtime
    enabled: false
    supportedArches:
      - amd64
    allowedHypervisorAnnotations: []
    containerd:
      snapshotter: nydus
      forceGuestPull: false
    crio:
      guestPull: true
    agent:
      httpsProxy: ""
      noProxy: ""
  qemu-se: # golang runtime
    enabled: false
    supportedArches:
      - s390x
    allowedHypervisorAnnotations: []
    containerd:
      snapshotter: nydus
      forceGuestPull: false
    crio:
      guestPull: true
    agent:
      httpsProxy: ""
      noProxy: ""
  qemu-se-runtime-rs: # rust runtime
    enabled: false
    supportedArches:
      - s390x
    allowedHypervisorAnnotations: []
    containerd:
      snapshotter: nydus
      forceGuestPull: false
    crio:
      guestPull: true
    agent:
      httpsProxy: ""
      noProxy: ""
  qemu-cca: # golang runtime
    enabled: false
    supportedArches:
      - arm64
    allowedHypervisorAnnotations: []
    containerd:
      snapshotter: nydus
      forceGuestPull: false
    crio:
      guestPull: true
    agent:
      httpsProxy: ""
      noProxy: ""
  qemu-coco-dev: # golang runtime
    enabled: false
    supportedArches:
      - amd64
      - arm64
      - s390x
      - ppc64le
    allowedHypervisorAnnotations: []
    containerd:
      snapshotter: nydus
      forceGuestPull: false
    crio:
      guestPull: true
    agent:
      httpsProxy: ""
      noProxy: ""
  qemu-coco-dev-runtime-rs: # rust runtime
    enabled: false
    supportedArches:
      - amd64
      - arm64
      - s390x
      - ppc64le
    allowedHypervisorAnnotations: []
    containerd:
      snapshotter: nydus
      forceGuestPull: false
    crio:
      guestPull: true
    agent:
      httpsProxy: ""
      noProxy: ""

# Default shim per architecture
# Since shims are disabled by default, you must explicitly configure defaultShim
# for the architectures you're using.
# Example:
#   defaultShim:
#     amd64: shim
defaultShim:
  amd64: qemu
  arm64: qemu
  s390x: qemu
  ppc64le: qemu

runtimeClasses:
  enabled: true
  createDefault: false
  defaultName: "kata"

env:
  installationPrefix: ""
  hostOS: ""
  # Suffix for multi-install deployments to avoid conflicts between multiple Kata installations
  # NOTE: When set, the default RuntimeClass (runtimeClasses.createDefault) will NOT be created
  #       to avoid naming conflicts. Use fully qualified RuntimeClass names (e.g., kata-qemu-suffix1).
  multiInstallSuffix: ""
  
  # DEPRECATED: Use 'runtimeClasses.enabled' and 'runtimeClasses.createDefault' instead
  # Will be removed in 2 releases
  createRuntimeClasses: "false"
  createDefaultRuntimeClass: "false"
  
  # DEPRECATED: Use structured 'shims' and 'defaultShim' sections above
  # Will be removed in 2 releases
  debug: ""
  shims: ""
  shims_x86_64: ""
  shims_aarch64: ""
  shims_s390x: ""
  shims_ppc64le: ""
  defaultShim: ""
  defaultShim_x86_64: ""
  defaultShim_aarch64: ""
  defaultShim_s390x: ""
  defaultShim_ppc64le: ""
  allowedHypervisorAnnotations: ""
  _experimentalSetupSnapshotter: ""
  snapshotterHandlerMapping: ""
  snapshotterHandlerMapping_x86_64: ""
  snapshotterHandlerMapping_aarch64: ""
  snapshotterHandlerMapping_s390x: ""
  snapshotterHandlerMapping_ppc64le: ""
  agentHttpsProxy: ""
  agentNoProxy: ""
  pullTypeMapping: ""
  pullTypeMapping_x86_64: ""
  pullTypeMapping_aarch64: ""
  pullTypeMapping_s390x: ""
  pullTypeMapping_ppc64le: ""
  _experimentalForceGuestPull: ""
  _experimentalForceGuestPull_x86_64: ""
  _experimentalForceGuestPull_aarch64: ""
  _experimentalForceGuestPull_s390x: ""
  _experimentalForceGuestPull_ppc64le: ""

# Node Feature Discovery (NFD) configuration
# node-feature-discovery is used to detect hardware features, including virtualization support
#
# When enabled, kata-deploy will manage NFD as a subchart and enforce virtualization checks:
#   - x86_64: Requires Intel VT-x (VMX) or AMD-V (SVM) CPU features
#   - aarch64, s390x, ppc64le, riscv64: Always allowed (specific virt detection not yet implemented)
#
# NFD will use its default configuration which includes detecting CPU features like VMX and SVM
#
# IMPORTANT: If you already have node-feature-discovery installed independently in your
#            cluster, keep this disabled.
#
#            When disabled, NO virtualization checks will be enforced (we **DO NOT**
#            control any external node-feature-discovery configuration).
#
#            If you want virtualization checks with an external node-feature-discovery
#            deployment, use nodeSelector manually.
node-feature-discovery:
  enabled: false
